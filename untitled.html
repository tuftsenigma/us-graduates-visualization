<script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
<script src="datamaps.usa.min.js"></script>
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Roboto+Condensed">


<style>
    text {
        font: "Roboto Condensed", Helvetica, sans-serif;
    } 
</style>

<div id="title" style="height: 5px; font-family: 'Roboto Condensed';"></div>
<!-- <div id="container" style="position: relative; left: -120px; height: 550px;"></div>
 --><div id="container" style="height: 100%;"></div>


<script>

    d3.select("#title").append("svg")
                .attr("width", document.getElementById("container").clientWidth)
                .attr("height", 50)
                .append("text")
                .attr("x", 70)             
                .attr("y", 40)
                .style("font", "Roboto Condensed")
                .style("font-size", "120%")
                .text("2013-14 Jumbo Grads in the United States");

    d3.select("#title").append("svg")
                .attr("width", document.getElementById("container").clientWidth)
                .attr("height", 50)
                .append("text")
                .attr("x", 70)             
                .attr("y", 12)
                .attr("fill", "#989898")
                .style("font", "Roboto Condensed")
                .style("font-size", "14px")
                .text("Domestic first outcomes of Tufts graduates (hover for statistics)");

    var map = new Datamap({
      responsive: true,
      width :parseInt(document.getElementById("container").clientWidth),
      height:parseInt(d3.select('#container').style('height'), 10),
      element: document.getElementById('container'),
      scope: 'usa',
      geographyConfig: {
      popupTemplate: function(geography, data) {
        // return '<div style="border-radius:10px; padding: 10px; position: fixed; top: 470px; left: 200px; opacity: 0.85;" class="hoverinfo"><b><div style="font-size:20px">' + geography.properties.name + '</div></b>' + "<br>" + 
        // '<b>Reported # of grads:</b><span style="margin-left:57px">' +  data["number of grads"] + '</span><br>' +        
        // '<b>Most popular field of study:</b><span style="margin-left:20px">' +  data["most popular major"] + '</span><br>' +
        // '<b>Most popular position:</b><span style="margin-left:45px">' +  data["most popular position"] + '</span><br>' +
        // '<b>Most popular destination:</b><span style="margin-left:30px">' +  data["most popular city"] + '</span><br>' +
        // '<b>Most popular institution:</b><span style="margin-left:35px">' +  data["most popular institution"] + '</span><br>';
        // }
        return '<div style="border-radius:10px; padding: 10px; opacity: 0.85;" class="hoverinfo"><b><div style="font-size:20px">' + geography.properties.name + '</div></b>' + "<br>" + 
        '<b>Reported # of grads:</b><span style="margin-left:57px">' +  data["number of grads"] + '</span><br>' +        
        '<b>Most popular field of study:</b><span style="margin-left:20px">' +  data["most popular major"] + '</span><br>' +
        '<b>Most popular position:</b><span style="margin-left:45px">' +  data["most popular position"] + '</span><br>' +
        '<b>Most popular destination:</b><span style="margin-left:30px">' +  data["most popular city"] + '</span><br>' +
        '<b>Most popular institution:</b><span style="margin-left:35px">' +  data["most popular institution"] + '</span><br>';
        }


    },
      fills: {
            "0" : "#EAE7E6",
            "1-9": '#C1B7B2',
            "10-19": '#988780',
            "20-49": '#6E574D',
            "50-99": '#593F33',
            "100+": '#300F00',
            defaultFill: '#EAE7E6'
        },
    dataUrl : "usData.json",

    });

    d3.select(window).on('resize', resize); 

    function resize() {
        // // update width
        map.updateChoropleth({
            responsive: false,
        });
        map.resize();
        d3.select("#title").attr("width", document.getElementById("container").clientWidth);



    }

</script>